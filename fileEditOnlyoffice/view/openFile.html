<!DOCTYPE html>
<html lang="en" style="height: 100%;">

<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="http://121.37.39.206:8166/web-apps/apps/api/documents/api.js"></script>
    <script type="text/javascript" language="javascript">

        function getParameterByName(name) {
            name = name.replace(/[\[\]]/g, "\\$&");
            var url = window.location.href;
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
            var results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        var key = getParameterByName('key');
        var url = getParameterByName('url');
        var name = getParameterByName('name');
        var type = getParameterByName('type');
        var documentType = handleDocType(type);


        var config = {
            "type": "desktop",
            "mode": "review",
            "documentType": documentType,
            "document": {
                "title": name,
                "url": url,
                "fileType": type,
                "key": key,
                "info": {},
                "permissions": {
                    "comment": true,
                    "copy": true,
                    "download": true,
                    "edit": true,
                    "print": true,
                    "fillForms": true,
                    "modifyFilter": true,
                    "modifyContentControl": true,
                    "review": true,
                    "commentGroups": {},
                    "shareReview": false
                }
            },
            "editorConfig": {
                "mode": "edit",
                "callbackUrl": "http://121.37.39.206:8128/office/callback",
                "lang": "zh",
                "createUrl": "",
                "templates": [
                    {
                        "icon": "",
                        "name": "Blank",
                        "url": "http://121.37.39.206:8166/OnlineEditorsExampleJava_war_exploded/EditorServlet?fileExt=docx"
                    },
                    {
                        "icon": "http://121.37.39.206:8166/OnlineEditorsExampleJava_war_exploded/css/img/file_docx.svg",
                        "name": "With sample content",
                        "url": "http://121.37.39.206:8166/OnlineEditorsExampleJava_war_exploded/EditorServlet?fileExt=docx&sample=true"
                    }
                ],
                "user": {
                    "id": "1",
                    "name": "zrx"
                },
                "customization": {
                    "goback": {
                        "url": "http://121.37.39.206:8166/OnlineEditorsExampleJava_war_exploded/IndexServlet"
                    },
                    "forcesave": false,
                    "submitForm": false,
                    "about": true,
                    "feedback": false,
                    "logo": {
                        "image": "http://124.220.42.243:8083/filesUpload/view/images/binglingsmall.png"
                    }
                },
                "canCoAuthoring": true,
                "canUseHistory": true,
                "canHistoryClose": true,
                "canHistoryRestore": false,
                "canSendEmailAddresses": false,
                "canRequestEditRights": true,
                "canRequestClose": false,
                "canRename": false,
                "canMakeActionLink": true,
                "canRequestUsers": true,
                "canRequestSendNotify": true,
                "canRequestSaveAs": false,
                "canRequestInsertImage": true,
                "canRequestMailMergeRecipients": true
            },
            "width": "100%",
            "height": "100%",
            "events": {},
            "frameEditorId": "iframeEditor"

        }

        var connectEditor = function () {
            new DocsAPI.DocEditor("placeholder", config);
        };

        if (window.addEventListener) {
            window.addEventListener("load", connectEditor);
        } else if (window.attachEvent) {
            window.attachEvent("load", connectEditor);
        }

        function handleDocType(fileType) {
            let docType = '';
            let fileTypesDoc = [
                'doc', 'docm', 'docx', 'dot', 'dotm', 'dotx', 'epub', 'fodt', 'htm', 'html', 'mht', 'odt', 'ott', 'pdf', 'rtf', 'txt', 'djvu', 'xps'
            ];
            let fileTypesCsv = [
                'csv', 'fods', 'ods', 'ots', 'xls', 'xlsm', 'xlsx', 'xlt', 'xltm', 'xltx'
            ];
            let fileTypesPPt = [
                'fodp', 'odp', 'otp', 'pot', 'potm', 'potx', 'pps', 'ppsm', 'ppsx', 'ppt', 'pptm', 'pptx'
            ];
            if (fileTypesDoc.includes(fileType)) {
                docType = 'text'
            }
            if (fileTypesCsv.includes(fileType)) {
                docType = 'spreadsheet'
            }
            if (fileTypesPPt.includes(fileType)) {
                docType = 'presentation'
            }
            return docType;
        }

    </script>
    <title>在线编辑文档</title>
</head>

<body style="height: 100%; margin: 0;">
    <div id="placeholder" style="height: 100%"></div>
</body>

</html>